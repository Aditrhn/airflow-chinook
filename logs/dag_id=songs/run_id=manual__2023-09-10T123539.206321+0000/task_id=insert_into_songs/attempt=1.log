[2023-09-10T12:35:40.099+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: songs.insert_into_songs manual__2023-09-10T12:35:39.206321+00:00 [queued]>
[2023-09-10T12:35:40.104+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: songs.insert_into_songs manual__2023-09-10T12:35:39.206321+00:00 [queued]>
[2023-09-10T12:35:40.105+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-09-10T12:35:40.115+0000] {taskinstance.py:1382} INFO - Executing <Task(GenericTransfer): insert_into_songs> on 2023-09-10 12:35:39.206321+00:00
[2023-09-10T12:35:40.120+0000] {standard_task_runner.py:57} INFO - Started process 3404 to run task
[2023-09-10T12:35:40.122+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'songs', 'insert_into_songs', 'manual__2023-09-10T12:35:39.206321+00:00', '--job-id', '94', '--raw', '--subdir', 'DAGS_FOLDER/songs.py', '--cfg-path', '/tmp/tmpjokphd3l']
[2023-09-10T12:35:40.123+0000] {standard_task_runner.py:85} INFO - Job 94: Subtask insert_into_songs
[2023-09-10T12:35:40.153+0000] {task_command.py:415} INFO - Running <TaskInstance: songs.insert_into_songs manual__2023-09-10T12:35:39.206321+00:00 [running]> on host 80a7ead3f1b6
[2023-09-10T12:35:40.202+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Aditiya Rahman' AIRFLOW_CTX_DAG_ID='songs' AIRFLOW_CTX_TASK_ID='insert_into_songs' AIRFLOW_CTX_EXECUTION_DATE='2023-09-10T12:35:39.206321+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-09-10T12:35:39.206321+00:00'
[2023-09-10T12:35:40.208+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-09-10T12:35:40.220+0000] {base.py:73} INFO - Using connection ID 'datawarehouse' for task execution.
[2023-09-10T12:35:40.221+0000] {generic_transfer.py:77} INFO - Extracting data from postgres
[2023-09-10T12:35:40.221+0000] {generic_transfer.py:78} INFO - Executing: 
 
SELECT a."ArtistId", 
       a."Name", 
       b."AlbumId",
       b."Title",
       c."TrackId", 
       c."Name", 
       c."UnitPrice",
       c."Bytes",
       d."GenreId",
       d."Name"
FROM "Artist" a
JOIN "Album" b
ON a."ArtistId" = b."ArtistId"
JOIN "Track" c
ON b."AlbumId" = c."AlbumId"
JOIN "Genre" d
ON c."GenreId" = d."GenreId"
[2023-09-10T12:35:40.226+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-09-10T12:35:40.229+0000] {sql.py:418} INFO - Running statement: 
SELECT a."ArtistId", 
       a."Name", 
       b."AlbumId",
       b."Title",
       c."TrackId", 
       c."Name", 
       c."UnitPrice",
       c."Bytes",
       d."GenreId",
       d."Name"
FROM "Artist" a
JOIN "Album" b
ON a."ArtistId" = b."ArtistId"
JOIN "Track" c
ON b."AlbumId" = c."AlbumId"
JOIN "Genre" d
ON c."GenreId" = d."GenreId", parameters: None
[2023-09-10T12:35:40.234+0000] {sql.py:427} INFO - Rows affected: 3503
[2023-09-10T12:35:40.238+0000] {generic_transfer.py:95} INFO - Running preoperator
[2023-09-10T12:35:40.238+0000] {generic_transfer.py:96} INFO - ['DROP TABLE IF EXISTS songs', '\n        CREATE TABLE songs (\n        ArtistId INT NOT NULL,\n        ArtistName VARCHAR(120),\n        AlbumId INT NOT NULL,\n        AlbumTitle VARCHAR(160) NOT NULL,\n        TrackId INT NOT NULL,\n        TrackName VARCHAR(200) NOT NULL,\n        TrackUnitPrice NUMERIC(10,2) NOT NULL,\n        TrackBytes INT,\n        GenreId INT NOT NULL,\n        GenreName VARCHAR(120)\n        )\n        ']
[2023-09-10T12:35:40.242+0000] {base.py:73} INFO - Using connection ID 'datawarehouse' for task execution.
[2023-09-10T12:35:40.244+0000] {sql.py:418} INFO - Running statement: DROP TABLE IF EXISTS songs, parameters: None
[2023-09-10T12:35:40.244+0000] {sql.py:418} INFO - Running statement: 
        CREATE TABLE songs (
        ArtistId INT NOT NULL,
        ArtistName VARCHAR(120),
        AlbumId INT NOT NULL,
        AlbumTitle VARCHAR(160) NOT NULL,
        TrackId INT NOT NULL,
        TrackName VARCHAR(200) NOT NULL,
        TrackUnitPrice NUMERIC(10,2) NOT NULL,
        TrackBytes INT,
        GenreId INT NOT NULL,
        GenreName VARCHAR(120)
        )
        , parameters: None
[2023-09-10T12:35:40.262+0000] {generic_transfer.py:105} INFO - Inserting rows into datawarehouse
[2023-09-10T12:35:40.266+0000] {base.py:73} INFO - Using connection ID 'datawarehouse' for task execution.
[2023-09-10T12:35:40.380+0000] {sql.py:512} INFO - Loaded 1000 rows into songs so far
[2023-09-10T12:35:40.487+0000] {sql.py:512} INFO - Loaded 2000 rows into songs so far
[2023-09-10T12:35:40.603+0000] {sql.py:512} INFO - Loaded 3000 rows into songs so far
[2023-09-10T12:35:40.666+0000] {sql.py:515} INFO - Done loading. Loaded a total of 3503 rows into songs
[2023-09-10T12:35:40.672+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=songs, task_id=insert_into_songs, execution_date=20230910T123539, start_date=20230910T123540, end_date=20230910T123540
[2023-09-10T12:35:40.695+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2023-09-10T12:35:40.706+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
